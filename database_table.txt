User_Account
id
store_id (Foregin Key)
role_permissions_id (Foregin Key)
username
email
mobile_number
first_name
middle_name
last_name
isOnline
isStatus
isArchive
date_created

Roles_Permissions
id
role_name
can_read
can_write
can_edit
can_delete
date_created
isArchive

User_Securty
id
user_id (Foregin Key)
password
password_salt
mfa_enabled
mfa_secret
failed_login_attempts
account_locked
lockout_time
last_login
last_logout
last_password_change

Customer
id (Primary Key)
store_id (Foregin Key)
address_id (Foregin Key)  
c_firstname
c_middlename
c_lastname
c_username
c_number
c_email
isAgreement
isOnline
isArchive
date_created

Customer_Securty
id (Primary Key)
customer_id (Foregin Key)
c_password
c_password_salt
mfa_enabled
mfa_secret
failed_login_attempts
account_locked
lockout_time
last_login
last_logout
last_password_change


--> Stores <--
id (Primary Key)
address_id (Foregin Key)
store_no
store_name
store_contact
store_email
is_main_store
updated_at
date_created
isStatus
isArchive

--> Addresses <--
id (Primary Key)
address_line1
address_line2
country
province
city
postal_code
latitude
longitude
updated_at

Laundry_Unit
id  (Primary Key)
store_id (Foregin Key)
unit_name
date_created
isUnitStatus (0 -> its Available, 1 -> its occupied  2 -> its Reserved 3 -> In Maintainance)
isArchive

--> Item Category <--
id (Primary Key)
category_name
isArchive
updated_at
date_created

--> Item <--
id (Primary Key)
category_id (Foregin Key)
item_code
item_name
isArchive
updated_at
date_created

--> Inventory <--
id (Primary Key)
store_id (Foregin Key)
item_id (Foregin Key)
price
quantity
isStatus

--> Laundry_Unit <--
id  (Primary Key)
store_id (Foregin Key)
unit_name
date_created
isUnitStatus (0 -> its Available, 1 -> its occupied  2 -> its Reserved 3 -> In Maintainance)
isArchive

--> Service_Request <--
id (Primary Key)
store_id (Foregin Key)
user_id (Foregin Key)
customer_id (Foregin Key)
service_type_id (Foregin Key)
tracking_code
customer_fullname
customer_type
notes
request_date
pickup_date
delivery_date
request_status
qr_code
qr_code_generated (BOOLEAN)
isPickup (BOOLEAN)
isDelivery  (BOOLEAN)


--> Service_Type <--
id (Primary Key)
store_id (Foregin Key)
service_name
default_price
date_created
isArchive

--> Service_Promotions <--
id (Primary Key)
service_id (Foregin Key)
discount_percentage
discount_price
valid_days
start_date
end_date
isActive
date_created
isArchive

--> Activity Log <--
id (Primary Key)
user_id (Foregin Key)
user_type 
action_type
action_description
timestamp

--> Laundry_Assignment <--
id (Primary Key)
service_request_id (Foregin Key)
unit_id (Foregin Key)
assigned_by (Foregin Key)
weight
assigned_at 
completed_at
isAssignmentStatus 0 = In Progress, 1 = Completed, 2 = Canceled
isCompleted

--> Transaction <--
id (Primary Key)
assigment_id (Foregin Key)
total_amount,
payment_method,
status
created_at
updated_at


--> Related_Item <--
id (Primary Key)
assigment_id (Foregin Key)
inventory_id (Foregin Key)
quantity,
amount,

--> Message <--
id (Primary Key)
sender_customer_id (NULL) (Foregin Key)
sender_user_account_id (NULL)
recipient_customer_id (NULL)
recipient_user_account_id (NULL)
message

isRead
date_sent

--> User_Account <--
id
store_id (Foregin Key)
role_permissions_id (Foregin Key)
username
email
mobile_number
first_name
middle_name
last_name
isOnline
isStatus
isArchive
date_created

--> Customer <--
id (Primary Key)
store_id (Foregin Key)
address_id (Foregin Key)  
c_firstname
c_middlename
c_lastname
c_username
c_number
c_email
isAgreement
isOnline
isArchive
date_created

sender_type
receiver_type


// #MESSAGE
--> Conversations <--
id (Primary Key)
customer_id (Foregin Key, Nullable) From Customer  
user_id1 (Foregin Key)  From User_Account
user_id2 (Foregin Key , Nullable)  From User_Account
created_at
updated_at
last_message_at
is_archived

--> Messages <--
id (Primary Key)
conversation_id (Foregin Key) From Conversations  
sender_id (Foregin Key)   References either the User_Account or Customer table
sender_type
content
sent_at
is_read





 sr.store_id = ? AND sr.request_status = 'In Queue'

--> Service_Progress <--
id (Primary Key)
service_request_id (Foregin Key)
stage
description
status_date
completed
false_description

--> Service_Request <--
id (Primary Key)
store_id (Foregin Key)
user_id (Foregin Key)
customer_id (Foregin Key)
service_type_id (Foregin Key)
tracking_code
customer_fullname
customer_type
notes
request_date
pickup_date
delivery_date
request_status
qr_code
qr_code_generated (BOOLEAN)
isPickup (BOOLEAN)
isDelivery  (BOOLEAN)

--> Laundry_Assignment <--
id (Primary Key)
service_request_id (Foregin Key)
unit_id (Foregin Key)
assigned_by (Foregin Key)
weight
assigned_at 
completed_at
isAssignmentStatus 0 = In Progress, 1 = Completed, 2 = Canceled
isCompleted

--> Transaction <--
id (Primary Key)
assigment_id (Foregin Key)
qr_code
total_amount,
transaction_date,
payment_method,
isStatus
isArhive


--> Conversations <--
id (Primary Key)
user_sender_id (Foregin Key) NULL
customer_sender_id (Foregin Key)  NULL
user_receiver_id (Foregin Key)  NULL
customer_receiver_id (Foregin Key)  NULL
last_message
last_message_date
created_at
updated_at

--> Messages <--
id (Primary Key)
conversation_id (FOREIGN)
sender_id 
receiver_id
sender_type
receiver_type
message
created_at
isRead

#here the customer who start convo to user
id | user_sender_id | customer_sender_id | user_receiver_id | customer_receiver_id
41        NULL                  1                  6                    NULL

BUT WHEN THE STAFF REPLAYING BACK ITS CREATE NEW CONVE WHY
id | user_sender_id | customer_sender_id | user_receiver_id | customer_receiver_id
41        NULL                  1                  6                    NULL
42          6                 NULL                 NULL                  1       <--- here the 





--> Notifications <--
https://isomorphic-furyroad.vercel.app/logistics

// Hard Part
Pending Pickup – The customer has placed a service request, but the clothes have not been picked up yet.
Ongoing Pickup – The delivery staff has picked up the clothes from the customer's location.
Completed Pickup – The delivery staff has picked up the clothes from the customer's location.


At Store – The clothes have been dropped off at the laundry store.
In Queue – The clothes are waiting for an available laundry unit.
In Laundry – The clothes have been assigned to a laundry unit and are currently being washed/dried.
Laundry Completed – The clothes have finished the washing/drying process.

Ready for Delivery – The clothes are ready to be delivered back to the customer.
Out for Delivery – The delivery staff is on the way to deliver the clothes to the customer.
Completed Delivery – The clothes have been delivered to the customer, and payment has been confirmed.
	
Canceled - its cancel the service request of the customer






// QUERY
CREATE TABLE Messages (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    conversation_id BIGINT NOT NULL,                     -- Reference to the Conversations table
    user_sender_id BIGINT,                               -- ID of the User sender (if applicable)
    customer_sender_id BIGINT,                           -- ID of the Customer sender (if applicable)
    message TEXT NOT NULL,                               -- The content of the message
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,      -- Timestamp of when the message was sent

    -- Foreign key references
    FOREIGN KEY (conversation_id) REFERENCES Conversations(id) ON DELETE CASCADE,
    FOREIGN KEY (user_sender_id) REFERENCES User_Account(id) ON DELETE CASCADE, 
    FOREIGN KEY (customer_sender_id) REFERENCES Customer(id) ON DELETE CASCADE 
);


CREATE TABLE Conversations (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_sender_id BIGINT,                   -- ID of the User sender (if applicable)
    customer_sender_id BIGINT,               -- ID of the Customer sender (if applicable)
    user_receiver_id BIGINT,                 -- ID of the User receiver (if applicable)
    customer_receiver_id BIGINT,             -- ID of the Customer receiver (if applicable)
    last_message TEXT,                       -- The content of the last message
    last_message_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP, -- Timestamp of the last message
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, -- Timestamp when the conversation was created
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, -- Timestamp of the last update

    -- Foreign key references
    FOREIGN KEY (user_sender_id) REFERENCES User_Account(id) ON DELETE CASCADE,
    FOREIGN KEY (customer_sender_id) REFERENCES Customer(id) ON DELETE CASCADE,
    FOREIGN KEY (user_receiver_id) REFERENCES User_Account(id) ON DELETE CASCADE,
    FOREIGN KEY (customer_receiver_id) REFERENCES Customer(id) ON DELETE CASCADE
);




















CREATE TABLE Messages (
    id INT AUTO_INCREMENT PRIMARY KEY,
    sender_customer_id INT NULL,  -- NULL if sender is from User_Account
    sender_user_account_id INT NULL,  -- NULL if sender is a Customer
    recipient_customer_id INT NULL,  -- NULL if recipient is from User_Account
    recipient_user_account_id INT NULL,  -- NULL if recipient is a Customer
    message TEXT NOT NULL,
    isRead BOOLEAN DEFAULT FALSE,
    date_sent TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (sender_customer_id) REFERENCES Customer(id),
    FOREIGN KEY (sender_user_account_id) REFERENCES User_Account(id),
    FOREIGN KEY (recipient_customer_id) REFERENCES Customer(id),
    FOREIGN KEY (recipient_user_account_id) REFERENCES User_Account(id)
);
